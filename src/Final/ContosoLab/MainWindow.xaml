<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="ContosoLab.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ContosoLab"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="ContosoLab - An AI-Powered Document Search App">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid x:Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel
            Margin="0,12,0,12"
            HorizontalAlignment="Center"
            Orientation="Vertical">
            <TextBlock
                HorizontalAlignment="Center"
                Style="{StaticResource SubtitleTextBlockStyle}"
                Text="AI-Powered Document Search" />
            <TextBlock HorizontalAlignment="Center" Text="Find information and get intelligent answers from your documents" />
        </StackPanel>

        <!--  Search Section  -->
        <Border Grid.Row="1" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox
                    x:Name="SearchTextBox"
                    Grid.Column="0"
                    Margin="0,0,8,0"
                    IsEnabled="False"
                    Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    x:Name="SearchButton"
                    Grid.Column="1"
                    Margin="0,0,4,0"
                    Click="SearchButton_Click"
                    IsEnabled="False"
                    Style="{StaticResource ModernButtonStyle}">
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <TextBlock
                            Margin="0,0,8,0"
                            VerticalAlignment="Center"
                            FontFamily="Segoe Fluent Icons"
                            FontSize="16"
                            Text="&#xE71E;" />
                        <TextBlock VerticalAlignment="Center" Text="Search" />
                    </StackPanel>
                </Button>

                <Button
                    x:Name="AskButton"
                    Grid.Column="2"
                    Margin="0,0,4,0"
                    Click="AskButton_Click"
                    IsEnabled="False"
                    Style="{StaticResource ModernButtonStyle}">
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <TextBlock
                            Margin="0,0,8,0"
                            VerticalAlignment="Center"
                            FontFamily="Segoe Fluent Icons"
                            FontSize="16"
                            Text="&#xE8F2;" />
                        <TextBlock VerticalAlignment="Center" Text="Ask AI" />
                    </StackPanel>
                </Button>

                <Button
                    x:Name="StopButton"
                    Grid.Column="3"
                    Margin="0,0,4,0"
                    Click="StopButton_Click"
                    Style="{StaticResource StopButtonStyle}"
                    Visibility="Collapsed">
                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <TextBlock
                            Margin="0,0,8,0"
                            VerticalAlignment="Center"
                            FontFamily="Segoe Fluent Icons"
                            FontSize="16"
                            Text="&#xE978;" />
                        <TextBlock VerticalAlignment="Center" Text="Stop" />
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!--  Pages Section  -->
        <Border Grid.Row="2" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Top">
                    <TextBlock
                        Margin="0,0,8,0"
                        VerticalAlignment="Center"
                        FontFamily="Segoe Fluent Icons"
                        FontSize="16"
                        Text="&#xF571;" />
                    <TextBlock
                        Grid.Row="0"
                        VerticalAlignment="Center"
                        FontWeight="SemiBold"
                        Text="Relevant pages" />
                </StackPanel>
                <ListBox
                        Grid.Row="1"
                        Padding="0,0,16,16"
                        Margin="0,0,0,8"
                        ScrollViewer.HorizontalScrollBarVisibility="Auto"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        ScrollViewer.HorizontalScrollMode="Enabled"
                        x:Name="PagesBox"
                        Background="Transparent"
                        BorderThickness="0">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border
                                    Margin="8,4"
                                    Padding="8"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="1"
                                    CornerRadius="8">
                                <Image
                                        MaxWidth="450"
                                        MaxHeight="600"
                                        Source="{Binding}"
                                        Stretch="Uniform" />
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <Border
                    Grid.Row="2"
                    Height="2"
                    Margin="-16,2"
                    Background="{ThemeResource SolidBackgroundFillColorSecondaryBrush}" />
                <!--  Results Section  -->
                <Grid Grid.Row="3" Margin=" 0,16,0,8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="1" Orientation="Horizontal">
                        <TextBlock
                            Margin="0,0,8,0"
                            VerticalAlignment="Center"
                            FontFamily="Segoe Fluent Icons"
                            FontSize="16"
                            Text="&#xE99A;" />
                        <TextBlock
                            Grid.Row="0"
                            VerticalAlignment="Center"
                            FontWeight="SemiBold"
                            Text="AI response" />
                    </StackPanel>

                    <Border
                        Grid.Row="2"
                        MinHeight="186"
                        Padding="16"
                        BorderThickness="1"
                        CornerRadius="8">
                        <ScrollViewer
                            Margin="-16,0,-16,0"
                            HorizontalScrollBarVisibility="Disabled"
                            VerticalScrollBarVisibility="Auto">
                            <TextBlock
                                x:Name="ResultsText"
                                FontSize="14"
                                Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                                LineHeight="24"
                                Text="Your AI-generated response will appear here..."
                                TextWrapping="Wrap" />
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Grid>
        </Border>
        <!--  Status Bar  -->
        <TextBlock
            x:Name="StatusText"
            Grid.Row="4"
            Margin="16,0,0,16"
            FontWeight="SemiBold"
            Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
            Text="Ready" />
    </Grid>

</Window>
